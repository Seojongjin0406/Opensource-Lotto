{% extends "base.html" %}
{% block title %}내 결과 - 로또{% endblock %}
{% block content %}
<div class="card shadow-sm card-rounded">
  <div class="card-body p-4">
    <h2 class="mb-3">사용자 결과</h2>

    <div class="mb-3">
      {% if winning %}
        <span class="badge bg-success-subtle text-success border border-success">
          {{ latest_round.round_no }}회차 당첨: {{ winning.numbers }} + 보너스({{ winning.bonus }})
        </span>
      {% elif latest_round %}
        <span class="badge bg-secondary">최근 회차({{ latest_round.round_no }}) 미추첨</span>
      {% else %}
        <span class="badge bg-secondary">회차 없음</span>
      {% endif %}
    </div>

    <div class="table-responsive">
      <table class="table table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>회차</th><th>이름</th><th>번호</th><th>등수/상태</th><th>시간</th>
          </tr>
        </thead>
        <tbody>
          {% for t in tickets %}
            <tr>
              <td>{{ t.round.round_no }}</td>
              <td>{{ t.name }}</td>
              <td class="font-monospace">{{ t.numbers }}</td>
              <td>
                {% if t.result_rank == "1등" %}
                  <span class="badge bg-danger">{{ t.result_rank }}</span>
                {% elif t.result_rank == "2등" %}
                  <span class="badge bg-warning text-dark">{{ t.result_rank }}</span>
                {% elif t.result_rank == "3등" %}
                  <span class="badge bg-info text-dark">{{ t.result_rank }}</span>
                {% elif t.result_rank == "4등" or t.result_rank == "5등" %}
                  <span class="badge bg-primary">{{ t.result_rank }}</span>
                {% elif t.result_rank == "미추첨" %}
                  <span class="badge bg-secondary">{{ t.result_rank }}</span>
                {% else %}
                  <span class="badge bg-light text-dark border">{{ t.result_rank }}</span>
                {% endif %}
              </td>
              <td>{{ t.created_at|date:"Y-m-d H:i" }}</td>
            </tr>
          {% empty %}
            <tr><td colspan="5" class="text-center text-secondary py-4">구매 내역이 없습니다.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="mt-3">
      <a class="btn btn-success" href="{% url 'buy_lotto' %}">다시 구매</a>
    </div>
  </div>
</div>
{% endblock %}
